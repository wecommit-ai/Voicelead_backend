datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id          String   @id @default(uuid()) @db.Uuid
  email       String   @unique
  password    String
  companyName String?
  booths      Booth[]
  createdAt   DateTime @default(now())
}

model Booth {
  id        String   @id @default(uuid()) @db.Uuid
  name      String?
  event     String
  location  String?
  userId    String   @db.Uuid
  user      User     @relation(fields: [userId], references: [id])
  leads     Lead[]
  createdAt DateTime @default(now())
  
  @@unique([userId]) // âœ… One booth per user constraint
}

model Lead {
  id      String @id @default(uuid()) @db.Uuid
  boothId String @db.Uuid
  booth   Booth  @relation(fields: [boothId], references: [id], onDelete: Cascade)

  name     String?
  email    String?
  company  String?
  phone    String?
  interest String?

  source      String?  // URL for voice recording or image
  type        String?  // 'voice', 'image', or 'manual'
  transcript  String?  // For voice recordings
  ocrText     String?  // For image OCR
  
  remarks     String?  // Fallback field for partial AI outputs
  confidence  Float?   // AI confidence score (0.0 to 1.0)
  rawAudioUrl String?  // Temporary storage URL for original audio (7 days)

  status      String   @default("new")
  captureMode String   @default("manual") // 'voice', 'image', or 'manual'
  createdAt   DateTime @default(now())
}
